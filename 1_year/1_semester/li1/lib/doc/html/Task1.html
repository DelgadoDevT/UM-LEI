<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Task1</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Joao Pedro Delgado Teixeira &lt;a106836@alunos.uminho.pt&gt;<br />Ricardo Miguel da Silva Morais &lt;a106935@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Task1</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module for the realisation of Task1 of LI1 in 2023/24.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:colisoesParede">colisoesParede</a> :: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li><li class="src short"><a href="#v:acC">acC</a> :: <a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a> -&gt; <a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a></li><li class="src short"><a href="#v:acP">acP</a> :: <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></li><li class="src short"><a href="#v:acH">acH</a> :: <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a> -&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></li><li class="src short"><a href="#v:colPar">colPar</a> :: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]] -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li><li class="src short"><a href="#v:colBloco">colBloco</a> :: [<a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a>] -&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a> -&gt; Bool</li><li class="src short"><a href="#v:findBlocP">findBlocP</a> :: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]] -&gt; [<a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a>]</li><li class="src short"><a href="#v:hitBlocos">hitBlocos</a> :: [<a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a>] -&gt; [<a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a>]</li><li class="src short"><a href="#v:hitPersona">hitPersona</a> :: <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></li><li class="src short"><a href="#v:colisoesPersonagens">colisoesPersonagens</a> :: <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li><li class="src short"><a href="#v:colPersona">colPersona</a> :: <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a> -&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a> -&gt; Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:colisoesParede" class="def">colisoesParede</a> <a href="#v:colisoesParede" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a></td><td class="doc"><p>Game Map</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Details of the character in questiona</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Logical value of the collision between map boundaries or platforms and the character</p></td></tr></table></div><div class="doc"><p>The <strong>colisoesParede</strong> function must test whether a character is colliding with any of the map's boundaries (sides or top) or with any platform blocks.
To obtain this result, we use auxiliary functions that perform the various operations required, such as:</p><ul><li><code>acC</code>: function that centres the positions of the game entities</li><li><code>acP</code>: function that centres the game entities</li><li><code>acH</code>: function that centres the hitboxes of game entities</li><li><code>colPar</code>: function that tests whether a character collides with the map boundaries</li><li><code>colBloco</code>: function that tests whether a character collides with a platform block</li><li><code>hitPersona</code>: function that calculates a character's hitbox, defined by a pair of positions, these being the bottom left and top right, respectively</li><li><code>hitBlocos</code>: function that calculates the hitbox of a list of platforms</li><li><code>findBlocP</code>: function that receives the map definition matrix and returns a list with the coordinates of the top left corner of each plataform block</li></ul><h2>Properties:</h2><h3>Main function &quot;colisoesParede&quot;:</h3><pre>colisoesParede :: Mapa -&gt; Personagem -&gt; Bool</pre><pre>colisoesParede (Mapa _ _ m) p</pre><pre>| colPar m (acP p) || colBloco (hitBlocos $ findBlocP m) (hitPersona (acP p)) = True</pre><pre>| otherwise = False</pre><h3>Auxiliary function &quot;acC&quot;:</h3><pre>acC :: Posicao -&gt; Posicao</pre><pre>acC (x, y) = (ar x, ar y)</pre><pre>where</pre><pre>ar :: Double -&gt; Double</pre><pre>ar n</pre><pre>| dP == 0.5 = n</pre><pre>| dP &gt;= 0.9 = fromIntegral (ceiling n) - 0.5</pre><pre>| otherwise = fromIntegral (floor n) + 0.5</pre><pre>where</pre><pre>dP = n - fromIntegral (floor n)</pre><h3>Auxiliary function &quot;acP&quot;:</h3><pre>acP :: Personagem -&gt; Personagem</pre><pre>acP (Personagem i1 i2 i3 i4 i5 i6 i7 i8 i9 i10) = Personagem i1 i2 (acC i3) i4 i5 i6 i7 i8 i9 i10</pre><h3>Auxiliary function &quot;acH&quot;:</h3><pre>acH :: Hitbox -&gt; Hitbox</pre><pre>acH ((a,b),(c,d)) = (acC (a,b), acC (c,d))</pre><h3>Auxiliary function &quot;colPar&quot;:</h3><pre>colPar :: [[Bloco]] -&gt; Personagem -&gt; Bool</pre><pre>colPar m (Personagem _ _ (x, y) _ (g, c) _ _ _ _ _)</pre><pre>| x - (g / 2) &lt;= 0 || x + (g / 2) &gt;= th || y - (c / 2) &lt;= 0 || y + (c / 2) &gt;= tv = True</pre><pre>| otherwise = False</pre><pre>where</pre><pre>th = fromIntegral $ length $ head m</pre><pre>tv = fromIntegral $ length m</pre><h3>Auxiliary function &quot;colBloco&quot;:</h3><pre>colBloco :: [Hitbox] -&gt; Hitbox -&gt; Bool</pre><pre>colBloco [] _ = False</pre><pre>colBloco (((xi1, yi1), (xi2, yi2)):xs) ((xe1, yd1), (xe2, yd2)) =</pre><pre>elem True [x &gt;= min xe1 xe2 &amp;&amp; x &lt;= max xe1 xe2 &amp;&amp; y &gt;= min yd1 yd2 &amp;&amp; y &lt;= max yd1 yd2 | (x, y) &lt;- v] || colBloco xs ((xe1, yd1), (xe2, yd2))</pre><pre>where</pre><pre>v = [(x, y) | x &lt;- [xi1, xi2], y &lt;- [yi1, yi2]]</pre><h3>Auxiliary function &quot;findBlocP&quot;:</h3><pre>findBlocP :: [[Bloco]] -&gt; [Posicao]</pre><pre>findBlocP [] = []</pre><pre>findBlocP m =</pre><pre>concatMap (\(l, bs) -&gt; [(fromIntegral c, fromIntegral l) | (b, c) &lt;- zip bs [0..], b == Plataforma]) $ zip [0..] m</pre><h3>Auxiliary function &quot;hitBlocos&quot;:</h3><pre>hitBlocos :: [Posicao] -&gt; [Hitbox]</pre><pre>hitBlocos = map (\(x, y) -&gt; ((x, y + 1), (x + 1, y)))</pre><h3>Auxiliary function &quot;hitPersona&quot;:</h3><pre>hitPersona :: Personagem -&gt; Hitbox</pre><pre>hitPersona (Personagem _ _ (x,y) _ (g,c) _ _ _ _ _)</pre><pre>= ((xe1,yd1),(xe2,yd2))</pre><pre>where</pre><pre>xe1 = x - (g / 2)</pre><pre>yd1 = y + (c / 2)</pre><pre>xe2 = x + (g / 2)</pre><pre>yd2 = y - (c / 2)</pre><h2>Examples of use: </h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>colisoesParede (Mapa ((0, 0), Este) (5, 5) [[Plataforma, Plataforma, Plataforma], [Plataforma, Vazio, Plataforma], [Plataforma, Plataforma, Plataforma]]) (Personagem (1, 0) Jogador (1, 1) Este (1, 1) False False 3 0 (False, 0))
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>colisoesParede (Mapa ((0, 0), Este) (5, 5) [[Vazio, Vazio, Vazio], [Vazio, Vazio, Vazio], [Vazio, Vazio, Vazio]]) (Personagem (1, 0) Jogador (1, 1) Este (1, 1) False False 3 0 (False, 0))
</code></strong>False
</pre></div></div><div class="top"><p class="src"><a id="v:acC" class="def">acC</a> <a href="#v:acC" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a></td><td class="doc"><p>Entity position</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a></td><td class="doc"><p>Centred position of the entity</p></td></tr></table></div><div class="doc"><p>Function that centres the positions of the game entities</p></div></div><div class="top"><p class="src"><a id="v:acP" class="def">acP</a> <a href="#v:acP" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Entity</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Centred position of the entity</p></td></tr></table></div><div class="doc"><p>Function that centres the game entities</p></div></div><div class="top"><p class="src"><a id="v:acH" class="def">acH</a> <a href="#v:acH" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></td><td class="doc"><p>Entity hitbox</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></td><td class="doc"><p>Centred entity hitbox</p></td></tr></table></div><div class="doc"><p>Function that centres the hitboxes of game entities</p></div></div><div class="top"><p class="src"><a id="v:colPar" class="def">colPar</a> <a href="#v:colPar" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]]</td><td class="doc"><p>Matrix that defines the map</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character in question</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Logical value of the character's collision with the map boundaries</p></td></tr></table></div><div class="doc"><p>Function that tests whether a character collides with the map boundaries</p></div></div><div class="top"><p class="src"><a id="v:colBloco" class="def">colBloco</a> <a href="#v:colBloco" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a>]</td><td class="doc"><p>List of hitboxes for each platform block</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></td><td class="doc"><p>Character hitbox</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Logical value of the platform blocks colliding with the character</p></td></tr></table></div><div class="doc"><p>Function that tests whether a character collides with a platform block</p></div></div><div class="top"><p class="src"><a id="v:findBlocP" class="def">findBlocP</a> <a href="#v:findBlocP" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]]</td><td class="doc"><p>Map definition matrix</p></td></tr><tr><td class="src">-&gt; [<a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a>]</td><td class="doc"><p>List of coordinates in the top left corner of the block</p></td></tr></table></div><div class="doc"><p>Function that receives the map definition matrix and returns a list with the coordinates of the top left corner of each plataform block</p></div></div><div class="top"><p class="src"><a id="v:hitBlocos" class="def">hitBlocos</a> <a href="#v:hitBlocos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12324.html#t:Posicao" title="LI12324">Posicao</a>]</td><td class="doc"><p>List of platform positions</p></td></tr><tr><td class="src">-&gt; [<a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a>]</td><td class="doc"><p>List of platform block hitboxes</p></td></tr></table></div><div class="doc"><p>Function that calculates the hitbox of a list of platforms</p></div></div><div class="top"><p class="src"><a id="v:hitPersona" class="def">hitPersona</a> <a href="#v:hitPersona" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character in question</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></td><td class="doc"><p>Hitbox of the character in question</p></td></tr></table></div><div class="doc"><p>Function that calculates a character's hitbox, defined by a pair of positions, these being the bottom left and top right, respectively.</p></div></div><div class="top"><p class="src"><a id="v:colisoesPersonagens" class="def">colisoesPersonagens</a> <a href="#v:colisoesPersonagens" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Entity 1</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Entity 2</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Logical value of the collision between the two entities</p></td></tr></table></div><div class="doc"><p>The <strong>colisoesPersonagens</strong> function should test whether two characters collide, i.e. whether the hitbox of the characters in question intersects in any way.
To define it, as well as using the auxiliary function <strong>hitPersona</strong> mentioned above, we also use:</p><ul><li><code>colPersona</code>: Function that checks if two hitboxes intersect</li></ul><h2>Properties:</h2><h3>Main function &quot;colisoesPersonagens&quot;:</h3><pre>colisoesPersonagens :: Personagem -&gt; Personagem -&gt; Bool</pre><pre>colisoesPersonagens p1 p2 = colPersona (hitPersona p1) (hitPersona p2)</pre><h3>Auxiliary function &quot;colPersona&quot;</h3><pre>colPersona :: Hitbox -&gt; Hitbox -&gt; Bool</pre><pre>colPersona ((xi1, yi1), (xi2, yi2)) ((xe1, yd1), (xe2, yd2)) =</pre><pre>elem True [x &gt;= min xe1 xe2 &amp;&amp; x &lt;= max xe1 xe2 &amp;&amp; y &gt;= min yd1 yd2 &amp;&amp; y &lt;= max yd1 yd2 | (x, y) &lt;- v]</pre><pre>where</pre><pre>v = [(x, y) | x &lt;- [xi1, xi2], y &lt;- [yi1, yi2]]</pre><h2>Examples of use:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>colisoesPersonagens (Personagem (1, 0) Jogador (1.5, 1.5) Este (1.5, 1.5) False False 3 0 (False, 0)) (Personagem (1, 0) Jogador (0.5, 0.5) Este (1, 1) False False 3 0 (False, 0))
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>colisoesPersonagens (Personagem (1, 0) Jogador (0.5, 0.5) Este (1, 1) False False 3 0 (False, 0)) (Personagem (1, 0) Jogador (2.5, 2.5) Este (1.5, 1.5) False False 3 0 (False, 0))
</code></strong>False
</pre></div></div><div class="top"><p class="src"><a id="v:colPersona" class="def">colPersona</a> <a href="#v:colPersona" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></td><td class="doc"><p>Character's hitbox</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Hitbox" title="LI12324">Hitbox</a></td><td class="doc"><p>Character's hitbox</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Logical value of the collision between two entities</p></td></tr></table></div><div class="doc"><p>Function that checks if two hitboxes intersect</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.27.0</p></div></body></html>