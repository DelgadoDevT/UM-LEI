<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Task4</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Joao Pedro Delgado Teixeira &lt;a106836@alunos.uminho.pt&gt;<br />Ricardo Miguel da Silva Morais &lt;a106935@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Task4</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module for the realisation of Task4 of LI1 in 2023/24.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:atualiza">atualiza</a> :: [Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a>] -&gt; Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a> -&gt; <a href="LI12324.html#t:Jogo" title="LI12324">Jogo</a> -&gt; <a href="LI12324.html#t:Jogo" title="LI12324">Jogo</a></li><li class="src short"><a href="#v:atualizaIni">atualizaIni</a> :: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a> -&gt; [Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a>] -&gt; [<a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a>] -&gt; [<a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a>]</li><li class="src short"><a href="#v:atualizaPer">atualizaPer</a> :: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a> -&gt; Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></li><li class="src short"><a href="#v:atualizaAcao">atualizaAcao</a> :: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a> -&gt; <a href="LI12324.html#t:Acao" title="LI12324">Acao</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></li><li class="src short"><a href="#v:subEscada">subEscada</a> :: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]] -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li><li class="src short"><a href="#v:movDireita">movDireita</a> :: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]] -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li><li class="src short"><a href="#v:movEsquerda">movEsquerda</a> :: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]] -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li><li class="src short"><a href="#v:parOp">parOp</a> :: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]] -&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a> -&gt; Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:atualiza" class="def">atualiza</a> <a href="#v:atualiza" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a>]</td><td class="doc"><p>Actions to apply to enemies</p></td></tr><tr><td class="src">-&gt; Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a></td><td class="doc"><p>Action to be applied to the player</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Jogo" title="LI12324">Jogo</a></td><td class="doc"><p>Game</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Jogo" title="LI12324">Jogo</a></td><td class="doc"><p>Updated Game</p></td></tr></table></div><div class="doc"><p>The <strong>atualiza</strong> function must validate the new directions and speeds of the characters (enemies and player) according to the actions given.
To define it, we need to use the following auxiliary functions:</p><ul><li><code>atualizaIni</code>: Function that updates the enemies according to the list of actions given</li><li><code>atualizaPer</code>: Function that updates the player character according to the given action</li></ul><p>To define these two auxiliary functions, we use other functions that will be called by them, such as:</p><ul><li><code>atualizaAcao</code>: Function that, given an action, updates a character's data.</li><li><code>subEscada</code>: Function that checks if a character is in the position of a Ladder type block.</li><li><code>movDireita</code>: Function that checks if a character cannot move to the right</li><li><code>movEsquerda</code>: Function that checks if a character cannot move to the left</li><li><code>parOp</code>: Function that checks if a character can be stationary</li></ul><h2>Properties:</h2><h3>Main function &quot;atualiza&quot;:</h3><pre>atualiza :: [Maybe Acao] -&gt; Maybe Acao -&gt; Jogo -&gt; Jogo</pre><pre>atualiza ap aj j@(Jogo m i c p) =</pre><pre>let</pre><pre>ni = atualizaIni m ap i</pre><pre>nj = atualizaPer m aj p</pre><pre>in</pre><pre>(Jogo m ni c nj)</pre><h4>Auxiliary function  &quot;atualizaIni&quot;:</h4><pre>atualizaIni :: Mapa -&gt; [Maybe Acao] -&gt; [Personagem] -&gt; [Personagem]</pre><pre>atualizaIni _ [] i = i</pre><pre>atualizaIni m (ac:acs) i =</pre><pre>case ac of</pre><pre>Just ac  -&gt; atualizaIni m acs (map (atualizaAcao m ac) i)</pre><pre>Nothing  -&gt;</pre><h4>Auxiliary function  &quot;atualizaPer&quot;:</h4><pre>atualizaPer :: Mapa -&gt; Maybe Acao -&gt; Personagem -&gt; Personagem</pre><pre>atualizaPer m mac p =</pre><pre>case mac of</pre><pre>Just ac -&gt; atualizaAcao m ac p</pre><pre>Nothing -&gt; p</pre><h4>Auxiliary function &quot;atualizaAcao&quot;:</h4><pre>atualizaAcao :: Mapa -&gt; Acao -&gt; Personagem -&gt; Personagem</pre><pre>atualizaAcao m@(Mapa m1 m2 m3) ac p@(Personagem (v1,v2) i2 i3 i4 i5 i6 i7 i8 i9 i10) =</pre><pre>case ac of</pre><pre>Subir         -&gt; if subEscada m3 pm then Personagem (v1,v2-1) i2 i3 i4 i5 i6 i7 i8 i9 i10 else p</pre><pre>Descer        -&gt; if subEscada m3 pm then Personagem (v1,v2+1) i2 i3 i4 i5 i6 i7 i8 i9 i10 else p</pre><pre>AndarDireita  -&gt; if movDireita m3 pm then Personagem (v1-1,v2) i2 i3 Oeste i5 i6 i7 i8 i9 i10 else Personagem (v1+1,v2) i2 i3 Este i5 i6 i7 i8 i9 i10</pre><pre>AndarEsquerda -&gt; if movEsquerda m3 pm then Personagem (v1+1,v2) i2 i3 Este i5 i6 i7 i8 i9 i10 else Personagem (v1-1,v2) i2 i3 Oeste i5 i6 i7 i8 i9 i10</pre><pre>Saltar        -&gt; if not i6 then Personagem (v1,v2-1) i2 i3 i4 i5 i6 i7 i8 i9 i10 else p</pre><pre>Parar         -&gt; if parOp m3 pm then Personagem (0,0) i2 i3 i4 i5 i6 i7 i8 i9 i10 else p</pre><pre>where</pre><pre>pm = acP p</pre><h4>Auxiliary function &quot;subEscada&quot;:</h4><pre>subEscada :: [[Bloco]] -&gt; Personagem -&gt; Bool</pre><pre>subEscada b p@(Personagem i1 i2 i3 i4 i5 s i7 i8 i9 i10)</pre><pre>| s = True</pre><pre>| any (== hitPersona p) (hitBlocos (findBlocE b)) = True</pre><pre>| otherwise = False</pre><h4>Auxiliary function &quot;movDireita&quot;:</h4><pre>movDireita :: [[Bloco]] -&gt; Personagem -&gt; Bool</pre><pre>movDireita b p@(Personagem i1 i2 (x, y) d i5 i6 r i8 i9 i10)</pre><pre>| r &amp;&amp; (`elem` findBlocP b) (snd (hitPersona p)) = True</pre><pre>| r &amp;&amp; (`elem` findBlocV b) (fst (fst (hitPersona p)) + 1, snd (fst (hitPersona p))) = True</pre><pre>| otherwise = False</pre><h4>Auxiliary function &quot;movEsquerda&quot;:</h4><pre>movEsquerda :: [[Bloco]] -&gt; Personagem -&gt; Bool</pre><pre>movEsquerda b p@(Personagem i1 i2 (x, y) d i5 i6 r i8 i9 i10)</pre><pre>| r &amp;&amp; (`elem` findBlocP b) (fst (snd (hitPersona p)) - 2, snd (snd (hitPersona p))) = True</pre><pre>| r &amp;&amp; (`elem` findBlocV b) (fst (fst (hitPersona p)) - 1, snd (fst (hitPersona p))) = True</pre><pre>| otherwise = False</pre><h4>Auxiliary function &quot;parOp&quot;:</h4><pre>parOp :: [[Bloco]] -&gt; Personagem -&gt; Bool</pre><pre>parOp b p@(Personagem i1 i2 (x, y) d i5 i6 r i8 i9 i10)</pre><pre>| (`elem` findBlocP b) (fst (hitPersona p)) = True</pre><pre>| otherwise = False</pre><h2>Examples of use:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>atualiza ([Just AndarDireita, Just AndarDireita]) ((Just Subir)) (Jogo (Mapa ((1.5, 1.5), Este) (5, 5) [[Escada, Vazio, Vazio], [Vazio, Vazio, Plataforma], [Plataforma, Plataforma, Plataforma]]) ([(Personagem (0, 0) Fantasma (1.5, 1.5) Este (1, 1) False True 1 0 (False, 0)),(Personagem (0, 0) Fantasma (0.5, 1.5) Oeste (1, 1) False False 1 0 (False, 0))]) ([(Moeda,(1.5,1.5)),(Martelo,(1.5,1.5))]) (Personagem (5, 0) Jogador (0.5, 0.5) Oeste (1, 1) True True 2 0 (True, 5)))
</code></strong>Jogo (Mapa ((1.5, 1.5), Este) (5, 5) [[Escada, Vazio, Vazio], [Vazio, Vazio, Plataforma], [Plataforma, Plataforma, Plataforma]]) ([(Personagem (-2, 0) Fantasma (1.5, 1.5) Oeste (1, 1) False True 1 0 (False, 0)),(Personagem (2, 0) Fantasma (0.5, 1.5) Este (1, 1) False False 1 0 (False, 0))]) ([(Moeda,(1.5,1.5)),(Martelo,(1.5,1.5))]) (Personagem (5, -1) Jogador (0.5, 0.5) Oeste (1, 1) True True 2 0 (True, 5))
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>atualiza ([Nothing]) (Nothing) Jogo (Mapa ((2.5, 1.5), Este) (5, 5) [[Plataforma, Plataforma, Plataforma, Plataforma, Plataforma], [Vazio, Vazio, Vazio, Vazio, Vazio], [Vazio, Alcapao, Vazio, Vazio, Vazio], [Vazio, Vazio, Vazio, Vazio, Vazio], [Plataforma, Plataforma, Plataforma, Plataforma, Plataforma]]) ([(Personagem (1, 0) Fantasma (3.0, 1.5) Oeste (1, 1) False True 1 0 (False, 0)),(Personagem (1, 0) Fantasma (0.5, 1.5) Oeste (1, 1) False True 1 0 (False, 0)),(Personagem (1, 0) Fantasma (2.5, 2.5) Oeste (1, 1) False True 0 0 (False, 0))]) ([(Martelo,(4.5,4.5))]) (Personagem (0, 0) Jogador (0.5, 1.5) Oeste (1, 1) False True 2 0 (True, 5))
</code></strong>Jogo (Mapa ((2.5, 1.5), Este) (5, 5) [[Plataforma, Plataforma, Plataforma, Plataforma, Plataforma], [Vazio, Vazio, Vazio, Vazio, Vazio], [Vazio, Alcapao, Vazio, Vazio, Vazio], [Vazio, Vazio, Vazio, Vazio, Vazio], [Plataforma, Plataforma, Plataforma, Plataforma, Plataforma]]) ([(Personagem (1, 0) Fantasma (3.0, 1.5) Oeste (1, 1) False True 1 0 (False, 0)),(Personagem (1, 0) Fantasma (0.5, 1.5) Oeste (1, 1) False True 1 0 (False, 0)),(Personagem (1, 0) Fantasma (2.5, 2.5) Oeste (1, 1) False True 0 0 (False, 0))]) ([(Martelo,(4.5,4.5))]) (Personagem (0, 0) Jogador (0.5, 1.5) Oeste (1, 1) False True 2 0 (True, 5))
</pre><p>Function that validates the new directions and speeds of the characters (enemies and player) according to the actions taken.</p></div></div><div class="top"><p class="src"><a id="v:atualizaIni" class="def">atualizaIni</a> <a href="#v:atualizaIni" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a></td><td class="doc"><p>Game map </p></td></tr><tr><td class="src">-&gt; [Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a>]</td><td class="doc"><p>List of actions</p></td></tr><tr><td class="src">-&gt; [<a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a>]</td><td class="doc"><p>Enemies List</p></td></tr><tr><td class="src">-&gt; [<a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a>]</td><td class="doc"><p>Updated enemies list</p></td></tr></table></div><div class="doc"><p>Function that updates enemies according to the list of actions given.</p></div></div><div class="top"><p class="src"><a id="v:atualizaPer" class="def">atualizaPer</a> <a href="#v:atualizaPer" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a></td><td class="doc"><p>Game map</p></td></tr><tr><td class="src">-&gt; Maybe <a href="LI12324.html#t:Acao" title="LI12324">Acao</a></td><td class="doc"><p>Action to be applied</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Player character </p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Player character updated after action</p></td></tr></table></div><div class="doc"><p>Function that updates the player's character according to the action taken.</p></div></div><div class="top"><p class="src"><a id="v:atualizaAcao" class="def">atualizaAcao</a> <a href="#v:atualizaAcao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12324.html#t:Mapa" title="LI12324">Mapa</a></td><td class="doc"><p>Game map </p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Acao" title="LI12324">Acao</a></td><td class="doc"><p>Action to be applied</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character </p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Updated character</p></td></tr></table></div><div class="doc"><p>Function that, given an action, updates a character's data.</p></div></div><div class="top"><p class="src"><a id="v:subEscada" class="def">subEscada</a> <a href="#v:subEscada" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]]</td><td class="doc"><p>Map definition matrix</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Truth value of the character being in the position of a Ladder block</p></td></tr></table></div><div class="doc"><p>Function that checks whether a character is in the position of a Ladder type block.</p></div></div><div class="top"><p class="src"><a id="v:movDireita" class="def">movDireita</a> <a href="#v:movDireita" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]]</td><td class="doc"><p>Map definition matrix</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>True value of the character not being able to move to the right</p></td></tr></table></div><div class="doc"><p>Function that checks if a character cannot move to the right.</p></div></div><div class="top"><p class="src"><a id="v:movEsquerda" class="def">movEsquerda</a> <a href="#v:movEsquerda" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]]</td><td class="doc"><p>Map definition matrix</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>rue value of the character not being able to move to the left</p></td></tr></table></div><div class="doc"><p>Function that checks if a character cannot move to the left.</p></div></div><div class="top"><p class="src"><a id="v:parOp" class="def">parOp</a> <a href="#v:parOp" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[<a href="LI12324.html#t:Bloco" title="LI12324">Bloco</a>]]</td><td class="doc"><p>Map definition matrix</p></td></tr><tr><td class="src">-&gt; <a href="LI12324.html#t:Personagem" title="LI12324">Personagem</a></td><td class="doc"><p>Character</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Truth value of the character being able to stand still </p></td></tr></table></div><div class="doc"><p>Function that checks whether a character can be stationary.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.27.0</p></div></body></html>